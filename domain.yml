version: "3.1"

intents:
  - greet
  - goodbye
  - mood
  - bot_challenge
  - journal_now
  - journal_later
  - remind_me
  - end_conversation
  - journal_entry
  - EXTERNAL_reminder
  - view_db


entities:
- mood
- remind_me


slots:
  mood:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: mood
  remind_me:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: remind_me
  journal_entry:
    type: text
    influence_conversation: false
    mappings:
    - type: from_text
      #intent: None
      conditions:
      - active_loop: journal_form
        requested_slot: journal_entry
      

responses:
  utter_greet:
  - text: "Hey! How are you?"

  utter_goodbye:
  - text: "Bye"

  utter_iamabot:
  - text: "I am a bot, powered by Rasa."

  utter_ask_mood:
  - text: "How are you feeling today?"
    buttons:
      - title: "Great"
        payload: '/mood{{"mood": "Great"}}'
      - title: "Good"
        payload: '/mood{{"mood":"Good"}}'
      - title: "Okay"
        payload: '/mood{{"mood":"So-so"}}'  
      - title: "Bad"
        payload: '/mood{{"mood":"Bad"}}'
      - title: "Terrible"
        payload: '/mood{{"mood":"Terrible"}}'  
      
      
  
  utter_journal:
  - text: "Do you want to journal now?"
    buttons:
      - title: "Yes"
        payload: "/journal_now"
      - title: "No/Later"
        payload: "/journal_later"

  utter_ask_journal_entry:  #a test
  - text: Why are you feeling {mood}?
  - text: How was your day?
  - text: Can you describe one thing you were grateful for today?
  - text: What can you do right now to make today a good day?
  - text: Can you tell me one positive and one negative thing of today?

  utter_journal_saved:
  - text: This journal entry was saved; {journal_entry}

  utter_journal_more:
  - text: Do you want to add to that?
    buttons:
      - title: "Yes"
        payload: "/journal_now"
      - title: "No"
        payload: "/end_conversation" 
      - title: "View my past entries"
        payload: "/view_db"

  utter_ask_later:
  - text: "Do you want me to remind you later?"
    buttons:
      - title: "15min"
        payload: '/remind_me{{"remind_me":"15"}}'
      - title: "30min"
        payload: '/remind_me{{"remind_me":"30"}}'
      - title: "1 hour"
        payload: '/remind_me{{"remind_me":"60"}}'
      - title: "4 hours"
        payload: '/remind_me{{"remind_me":"240"}}'
      - title: "Don't remind me"
        payload: '/remind_me{{"remind_me":"0"}}'
    # custom:
    #   input_type: "disable"
  
actions:
  - action_set_reminder
  - validate_journal_form
  - action_view_all_entries
  - action_reset_journal_slot

forms:
  journal_form:
    required_slots:
    - journal_entry


session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
